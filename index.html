<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>MiniCraft 2D Advanced</title>
<style>
body { background: #87ceeb; font-family: sans-serif; text-align: center; margin:0; padding:0; }
#game { display: grid; grid-template-columns: repeat(10, 40px); grid-gap: 2px; margin: 20px auto; }
.block { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
.player { background: yellow; }
.grass { background: #4CAF50; }
.stone { background: #808080; }
.tree { background: #8B4513; color: green; }
.inventory { margin-top: 10px; }
.item { display: inline-block; width: 40px; height: 40px; border: 1px solid black; font-size: 24px; line-height: 40px; vertical-align: middle; }
.selected { border: 3px solid red; }
</style>
</head>
<body>
<h1>MiniCraft 2D Advanced</h1>
<p>Piltangenter: flytta | S: samla | B: bygg | Mellanslag: hoppa | 1-3: byt block</p>
<div id="game"></div>
<div class="inventory">
  <div class="item selected" id="inv-grass">ðŸŒ¿ 0</div>
  <div class="item" id="inv-stone">ðŸª¨ 0</div>
  <div class="item" id="inv-tree">ðŸŒ³ 0</div>
</div>

<script>
const width = 10;
const height = 10;
let player = {x: 5, y: 8, vy:0}; // vy = vertikal hastighet
let selectedItem = "grass";
let inventory = {grass:0, stone:0, tree:0};
let world = [];

// Skapa vÃ¤rlden med slumpmÃ¤ssiga block
for (let y = 0; y < height; y++) {
    let row = [];
    for (let x = 0; x < width; x++) {
        if (y > 7) row.push("stone"); // mark
        else if (Math.random() < 0.1) row.push("tree");
        else row.push("grass");
    }
    world.push(row);
}

function drawWorld() {
    const game = document.getElementById("game");
    game.innerHTML = "";
    for (let y = 0; y < height; y++) {
        for (let x = 0; x < width; x++) {
            const div = document.createElement("div");
            div.classList.add("block");
            div.classList.add(world[y][x]);
            if (player.x === x && player.y === y) div.classList.add("player");
            game.appendChild(div);
        }
    }
    // uppdatera inventarie
    document.getElementById("inv-grass").textContent = `ðŸŒ¿ ${inventory.grass}`;
    document.getElementById("inv-stone").textContent = `ðŸª¨ ${inventory.stone}`;
    document.getElementById("inv-tree").textContent = `ðŸŒ³ ${inventory.tree}`;
}

function selectInventory(item) {
    selectedItem = item;
    document.querySelectorAll(".item").forEach(el => el.classList.remove("selected"));
    document.getElementById("inv-" + item).classList.add("selected");
}

// kontroll
const keys = {};
document.addEventListener("keydown", (e) => keys[e.key] = true);
document.addEventListener("keyup", (e) => keys[e.key] = false);

function update() {
    // Horisontell rÃ¶relse
    if (keys["ArrowLeft"] && player.x > 0 && world[player.y][player.x-1] === "grass") player.x--;
    if (keys["ArrowRight"] && player.x < width-1 && world[player.y][player.x+1] === "grass") player.x++;

    // Hoppa
    if (keys[" "] && player.vy === 0) player.vy = -2;

    // Gravitation
    if (player.y < height-1 && world[player.y+1][player.x] === "grass") {
        player.vy += 0.2; // gravitation
    } else {
        player.vy = 0;
    }
    player.y += player.vy;
    if (player.y > height-1) player.y = height-1;
    if (player.y < 0) player.y = 0;

    // Samla block
    if (keys["s"] || keys["S"]) {
        let block = world[Math.round(player.y)][player.x];
        if (block !== "grass" && block !== "player") {
            inventory[block]++;
            world[Math.round(player.y)][player.x] = "grass";
        }
    }

    // Bygg block
    if (keys["b"] || keys["B"]) {
        if (inventory[selectedItem] > 0) {
            world[Math.round(player.y)][player.x] = selectedItem;
            inventory[selectedItem]--;
        }
    }

    // Byt block med 1-3
    if (keys["1"]) selectInventory("grass");
    if (keys["2"]) selectInventory("stone");
    if (keys["3"]) selectInventory("tree");

    drawWorld();
    requestAnimationFrame(update);
}

drawWorld();
update();
</script>
</body>
</html>
